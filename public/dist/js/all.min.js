define("delFolder",function(t,e,n){"use strict";function o(){var t=$(this).parent(".widget-menu"),e=t.attr("data-target-id"),n=s.find("div[data-entity-id="+e+"]"),o=n.parent().parent().hasClass("sub-list"),a={folder_id:e,folder_level:n.attr("data-level")};$.ajax({url:"/delFolder",type:"POST",dataType:"JSON",data:a,success:function(t){if(t.is_delete_all){if(o){if(0===n.parent(".folder-item").siblings().length){var e=n.parent(".folder-item").parent(".sub-list"),a=e.prev(".item-cont");a.removeClass("folder-open"),a.children(".has-sub").find(".arr-icon").remove()}}n.next(".sub-list").remove(),n.remove()}}})}var a=$(".folder-menu"),i=a.eq(0).find(".delete"),r=a.eq(1).find(".delete"),l=$(".side-bar .folder-item-list"),s=l.find(".mCSB_container");i.on("click",o),r.on("click",o)}),define("delNote",function(t,e,n){"use strict";function o(){var t=a.attr("data-target-id"),e=r.find("div[data-entity-id="+t+"]"),n={note_id:t};$.ajax({url:"/delNote",type:"POST",dataType:"JSON",data:n,success:function(t){var n=e.parent(".view-item");if(0===n.siblings().length){l.html(""),l.append(s);var o=l.find(".empty-msg");o.css("margin-top",r.height()/2-20+"px"),$(window).on("resize",function(){o.css("margin-top",r.height()/2-20+"px")})}n.remove()}})}var a=$(".note-detail-menu"),i=a.find(".delete"),r=$(".view-list"),l=r.find(".mCSB_container");i.on("click",o);var s=['<div class="empty-msg">','<i class="due-if">&#xe8ea;</i><br>',"空文件夹","</div>"].join("")}),define("fullPage",function(t,e,n){"use strict";!function(t){if(!t)return console.warn("fullHeight needs jQuery");t.fn.fullHeight=function(e){function n(){var e=r.offset().top,n=o(l),a=t(window).height();r.css("height",a-e-3-n)}function o(e){var n=0;if(0===e.length)return n;n=10;for(var o=0;o<e.length;o++)n+=t("."+e[o]).height();return n}var a={main:"",extra:[]},i=t.extend(a,e),r=t(this),l=i.extra;n(),t(window).on("resize",n)}}(window.jQuery||t("jquery"))}),define("getNewestNote",function(t,e,n){"use strict";function o(){var t={is_new:!0};$.ajax({url:"/getNewestNote",type:"POST",dataType:"JSON",data:t,success:function(t){if(t.is_get&&""!==t.list_dom)r.html("").append(t.list_dom),i.find(".view-item").eq(0).trigger("click");else{r.html("").append(l);var e=r.find(".empty-msg");e.css("margin-top",i.height()/2-20+"px"),$(window).on("resize",function(){e.css("margin-top",i.height()/2-20+"px")})}var n=$(".side-bar-list");n.find(".selected").removeClass("selected"),n.find(".title-selected").removeClass("title-selected"),a.find(".item-cont").addClass("selected"),i.mCustomScrollbar("update")}})}t("customScrollBar");var a=$(".side-bar-main .newest"),i=$(".view-list"),r=i.find(".mCSB_container"),l=['<div class="empty-msg">',"您最近一周都没写笔记~~~","</div>"].join("");a.on("click",o)}),define("getSearchNote",function(t,e,n){"use strict";function o(){var t=l.val(),e={is_new:!0,keyword:t};if(""===t){var n=$(".warn-msg");return n.find(".msg-text").text("查找标题不能为空"),n.backLayer({closeCall:a}),!1}$.ajax({url:"/getSearchNote",type:"POST",dataType:"JSON",data:e,success:function(t){if(t.is_get&&""!==t.list_dom)c.html("").append(t.list_dom),s.find(".view-item").eq(0).trigger("click");else{c.html("").append(d);var e=c.find(".empty-msg");e.css("margin-top",s.height()/2-20+"px"),$(window).on("resize",function(){e.css("margin-top",s.height()/2-20+"px")})}var n=$(".side-bar-list");n.find(".selected").removeClass("selected"),n.find(".title-selected").removeClass("title-selected"),s.mCustomScrollbar("update")}})}function a(t,e){var n,o=1;n=setInterval(function(){0===--o&&(clearInterval(n),t.hide(),e.remove())},1e3)}t("customScrollBar"),t("backLayer");var i=$(".search-bar .search-cont"),r=i.find(".cns-btn"),l=i.find(".search-ipt"),s=$(".view-list"),c=s.find(".mCSB_container"),d=['<div class="empty-msg">',"抱歉没找到任何笔记~~~","</div>"].join("");r.on("click",o)}),define(function(t){function e(){i.toggleClass("page-side-close"),$(window).trigger("resize")}function n(t){t.find(".rename").on("click",function(){var e=t.attr("data-target-id");$("div[data-entity-id="+e+"]").find(".rename-cont").renameWidget()})}function o(){var t={},e=$(this),n=e.attr("data-entity-id");t.belong_folder_id=n,$.ajax({url:"/getNoteList",type:"POST",dataType:"JSON",data:t,success:function(t){var e="";if(t){var n=""===t.list_dom;e=n?f:t.list_dom;var o=c.find(".mCSB_container");if(o.html(""),o.append(e),n){var a=o.find(".empty-msg");a.css("margin-top",c.height()/2-20+"px"),$(window).on("resize",function(){a.css("margin-top",c.height()/2-20+"px")})}if(c.mCustomScrollbar("update"),0!==o.find(".view-item").length)o.find(".view-item").eq(0).trigger("click");else{d.html("").append(h);var a=d.find(".empty-editor");a.css("margin-top",c.height()/2-20+"px"),$(window).on("resize",function(){a.css("margin-top",c.height()/2-20+"px")}),d.prev(".bar-top").find(".name-cont").text("")}}c.mCustomScrollbar("scrollTo","top")}}),$(".side-bar-list").find(".selected").removeClass("selected"),m.removeClass("title-selected"),!e.hasClass("folder-list-title")?e.addClass("selected"):e.addClass("title-selected")}function a(t,e){var n,o=1;n=setInterval(function(){0===--o&&(clearInterval(n),t.hide(),e.remove())},1500)}t("fullPage"),t("mouseWheel"),t("customScrollBar"),t("widgetMenu"),t("renameWidget");var i=$(".main-box"),r=$(".side-close"),l=$(".side-open"),s=$(".folder-item-list"),c=$(".view-list"),d=$(".edit-cont");r.on("click",e),l.on("click",e),d[0]&&(d.fullHeight(),c.fullHeight(),s.fullHeight(),t("noteEdit"));var u={mouseWheelPixels:250,advanced:{autoScrollOnFocus:!1}};c.mCustomScrollbar(u),s.mCustomScrollbar(u),$(".version-list").mCustomScrollbar(u),s=$(".folder-item-list"),c=$(".view-list"),t("newNote"),t("newFolder"),t("delFolder"),t("delNote"),t("getNewestNote"),t("getSearchNote"),t("userMsgModify"),$(".share-box")[0]&&t("noteShare"),t("verMag"),$(".new-menu").widgetMenu({tri_par:".side-bar .new-btn",show_class:"blk-show"}),$(".flo-menu").widgetMenu({trigger:".item-cont",show_class:"blk-show",tri_par:".folder-item-list",is_left:!1,flo_mouse:!0,call:n}),$(".down-arr-menu").widgetMenu({trigger:".folder-item .down-arr",tri_par:".folder-item-list",show_class:"blk-show",flo_mouse:!0,call:n}),$(".note-detail-menu").widgetMenu({trigger:".item-cont",show_class:"blk-show",tri_par:".view-list",is_left:!1,flo_mouse:!0,call:n}),s.on("click",".arr-icon",function(){var t=$(this).parents(".item-cont"),e=t.next(".sub-list");t.toggleClass("folder-open"),e.toggleClass("list-open")}),s.on("click",".item-cont",o);var m=$(".side-bar .folder-list-title");m.on("click",o),m.trigger("click"),c.on("click",".item-cont",function(){var t=$(this);t.attr("data-entity-id")}),$(".note-detail-menu .share").on("click",function(){var t=$(this).parent(".widget-menu").attr("data-target-id"),e=c.find("div[data-entity-id="+t+"]").attr("data-type"),n=window.location.href.split("/")[2],o="http://"+n+"/share/"+t+"/"+e,i=$(['<input type="text">'].join(""));i.attr("value",o),c.prepend(i),i.select(),document.execCommand("Copy"),i.remove(),$(".warn-msg"),$(".warn-msg").find(".msg-text").text("链接已复制到剪贴板"),$(".warn-msg").backLayer({closeCall:a})});var f=($(".side-bar .new-btn"),$(".side-bar .new-menu"),['<div class="empty-msg">','<i class="due-if">&#xe8ea;</i><br>',"空文件夹","</div>"].join("")),h=['<div class="empty-editor"><i class="due-if">&#xe606;</i></div>'].join("")}),define("backLayer",function(t,e,n){"use strict";!function(t){if(!t)return console.warn("backLayer needs jQuery");t.fn.backLayer=function(e){function n(){var t=Math.max(document.documentElement.scrollWidth,document.documentElement.clientWidth)+"px",e=Math.max(document.documentElement.scrollHeight,document.documentElement.clientHeight)+"px";layer.css({width:t,height:e})}function o(){var e=t(document).scrollTop-c.height()/2+"px",n=t(document).scrollLeft-c.width()/2+"px";c.css({"margin-top":e,"margin-left":n})}var a={closeCall:function(){},bg_color:"#000"},i=t.extend(a,e),r=!!document.all,l=r&&!window.XMLHttpRequest,s=l?"absolute":"fixed",c=t(this),d=i.bg_color,u=i.closeCall;return this.each(function(){c.css({"z-index":"9999",display:"block",position:s,top:"50%",left:"50%","margin-top":-c.height()/2+"px","margin-left":-c.width()/2+"px"});var e=t('<div class="back-layer"></div>');e.css({width:"100%",height:"100%",position:s,top:"0px",left:"0px","background-color":d,"z-index":"9998",opacity:"0.5"}),t("body").append(e),r&&e.css("filter","alpha(opacity=60)"),l&&(n(),o()),t("window").resize(function(){n()}),u(c,e)})}}(window.jQuery||t("jquery"))}),define("customScrollBar",function(t,e,n){!function(t){var e={init:function(e){var n={set_width:!1,set_height:!1,horizontalScroll:!1,scrollInertia:950,mouseWheel:!0,mouseWheelPixels:"auto",autoDraggerLength:!0,autoHideScrollbar:!1,snapAmount:null,snapOffset:0,scrollButtons:{enable:!1,scrollType:"continuous",scrollSpeed:"auto",scrollAmount:40},advanced:{updateOnBrowserResize:!0,updateOnContentResize:!1,autoExpandHorizontalScroll:!1,autoScrollOnFocus:!0,normalizeMouseWheelDelta:!1},contentTouchScroll:!0,callbacks:{onScrollStart:function(){},onScroll:function(){},onTotalScroll:function(){},onTotalScrollBack:function(){},onTotalScrollOffset:0,onTotalScrollBackOffset:0,whileScrolling:function(){}},theme:"light"},e=t.extend(!0,n,e);return this.each(function(){var n=t(this);if(e.set_width&&n.css("width",e.set_width),e.set_height&&n.css("height",e.set_height),t(document).data("mCustomScrollbar-index")){var o=parseInt(t(document).data("mCustomScrollbar-index"));t(document).data("mCustomScrollbar-index",o+1)}else t(document).data("mCustomScrollbar-index","1");n.wrapInner("<div class='mCustomScrollBox mCS-"+e.theme+"' id='mCSB_"+t(document).data("mCustomScrollbar-index")+"' style='position:relative; height:100%; overflow:hidden; max-width:100%;' />").addClass("mCustomScrollbar _mCS_"+t(document).data("mCustomScrollbar-index"));var a=n.children(".mCustomScrollBox");if(e.horizontalScroll){a.addClass("mCSB_horizontal").wrapInner("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />");var i=a.children(".mCSB_h_wrapper");i.wrapInner("<div class='mCSB_container' style='position:absolute; left:0;' />").children(".mCSB_container").css({width:i.children().outerWidth(),position:"relative"}).unwrap()}else a.wrapInner("<div class='mCSB_container' style='position:relative; top:0;' />");var r=a.children(".mCSB_container");t.support.touch&&r.addClass("mCS_touch"),r.after("<div class='mCSB_scrollTools' style='position:absolute;'><div class='mCSB_draggerContainer'><div class='mCSB_dragger' style='position:absolute;' oncontextmenu='return false;'><div class='mCSB_dragger_bar' style='position:relative;'></div></div><div class='mCSB_draggerRail'></div></div></div>");var l=a.children(".mCSB_scrollTools"),s=l.children(".mCSB_draggerContainer"),c=s.children(".mCSB_dragger");if(e.horizontalScroll?c.data("minDraggerWidth",c.width()):c.data("minDraggerHeight",c.height()),e.scrollButtons.enable&&(e.horizontalScroll?l.prepend("<a class='mCSB_buttonLeft' oncontextmenu='return false;'></a>").append("<a class='mCSB_buttonRight' oncontextmenu='return false;'></a>"):l.prepend("<a class='mCSB_buttonUp' oncontextmenu='return false;'></a>").append("<a class='mCSB_buttonDown' oncontextmenu='return false;'></a>")),a.bind("scroll",function(){n.is(".mCS_disabled")||a.scrollTop(0).scrollLeft(0)}),n.data({mCS_Init:!0,mCustomScrollbarIndex:t(document).data("mCustomScrollbar-index"),horizontalScroll:e.horizontalScroll,scrollInertia:e.scrollInertia,scrollEasing:"mcsEaseOut",mouseWheel:e.mouseWheel,mouseWheelPixels:e.mouseWheelPixels,autoDraggerLength:e.autoDraggerLength,autoHideScrollbar:e.autoHideScrollbar,snapAmount:e.snapAmount,snapOffset:e.snapOffset,scrollButtons_enable:e.scrollButtons.enable,scrollButtons_scrollType:e.scrollButtons.scrollType,scrollButtons_scrollSpeed:e.scrollButtons.scrollSpeed,scrollButtons_scrollAmount:e.scrollButtons.scrollAmount,autoExpandHorizontalScroll:e.advanced.autoExpandHorizontalScroll,autoScrollOnFocus:e.advanced.autoScrollOnFocus,normalizeMouseWheelDelta:e.advanced.normalizeMouseWheelDelta,contentTouchScroll:e.contentTouchScroll,onScrollStart_Callback:e.callbacks.onScrollStart,onScroll_Callback:e.callbacks.onScroll,onTotalScroll_Callback:e.callbacks.onTotalScroll,onTotalScrollBack_Callback:e.callbacks.onTotalScrollBack,onTotalScroll_Offset:e.callbacks.onTotalScrollOffset,onTotalScrollBack_Offset:e.callbacks.onTotalScrollBackOffset,whileScrolling_Callback:e.callbacks.whileScrolling,bindEvent_scrollbar_drag:!1,bindEvent_content_touch:!1,bindEvent_scrollbar_click:!1,bindEvent_mousewheel:!1,bindEvent_buttonsContinuous_y:!1,bindEvent_buttonsContinuous_x:!1,bindEvent_buttonsPixels_y:!1,bindEvent_buttonsPixels_x:!1,bindEvent_focusin:!1,bindEvent_autoHideScrollbar:!1,mCSB_buttonScrollRight:!1,mCSB_buttonScrollLeft:!1,mCSB_buttonScrollDown:!1,mCSB_buttonScrollUp:!1}),e.horizontalScroll)"none"!==n.css("max-width")&&(e.advanced.updateOnContentResize||(e.advanced.updateOnContentResize=!0));else if("none"!==n.css("max-height")){var d=!1,u=parseInt(n.css("max-height"));n.css("max-height").indexOf("%")>=0&&(d=u,u=n.parent().height()*d/100),n.css("overflow","hidden"),a.css("max-height",u)}if(n.mCustomScrollbar("update"),e.advanced.updateOnBrowserResize){var m,f=t(window).width(),h=t(window).height();t(window).bind("resize."+n.data("mCustomScrollbarIndex"),function(){m&&clearTimeout(m),m=setTimeout(function(){if(!n.is(".mCS_disabled")&&!n.is(".mCS_destroyed")){var e=t(window).width(),o=t(window).height();f===e&&h===o||("none"!==n.css("max-height")&&d&&a.css("max-height",n.parent().height()*d/100),n.mCustomScrollbar("update"),f=e,h=o)}},150)})}if(e.advanced.updateOnContentResize){if(e.horizontalScroll)var p=r.outerWidth();else var p=r.outerHeight();setInterval(function(){if(e.horizontalScroll){e.advanced.autoExpandHorizontalScroll&&r.css({position:"absolute",width:"auto"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:r.outerWidth(),position:"relative"}).unwrap();var t=r.outerWidth()}else var t=r.outerHeight();t!=p&&(n.mCustomScrollbar("update"),p=t)},300)}})},update:function(){var e=t(this),n=e.children(".mCustomScrollBox"),o=n.children(".mCSB_container");o.removeClass("mCS_no_scrollbar"),e.removeClass("mCS_disabled mCS_destroyed"),n.scrollTop(0).scrollLeft(0);var a=n.children(".mCSB_scrollTools"),i=a.children(".mCSB_draggerContainer"),r=i.children(".mCSB_dragger");if(e.data("horizontalScroll")){var l=a.children(".mCSB_buttonLeft"),s=a.children(".mCSB_buttonRight"),c=n.width();e.data("autoExpandHorizontalScroll")&&o.css({position:"absolute",width:"auto"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:o.outerWidth(),position:"relative"}).unwrap();var d=o.outerWidth()}else var u=a.children(".mCSB_buttonUp"),m=a.children(".mCSB_buttonDown"),f=n.height(),h=o.outerHeight();if(h>f&&!e.data("horizontalScroll")){a.css("display","block");var p=i.height();if(e.data("autoDraggerLength")){var g=Math.round(f/h*p),v=r.data("minDraggerHeight");if(g<=v)r.css({height:v});else if(g>=p-10){var b=p-10;r.css({height:b})}else r.css({height:g});r.children(".mCSB_dragger_bar").css({"line-height":r.height()+"px"})}var S=r.height(),_=(h-f)/(p-S);e.data("scrollAmount",_).mCustomScrollbar("scrolling",n,o,i,r,u,m,l,s);var w=Math.abs(o.position().top);e.mCustomScrollbar("scrollTo",w,{scrollInertia:0,trigger:"internal"})}else if(d>c&&e.data("horizontalScroll")){a.css("display","block");var C=i.width();if(e.data("autoDraggerLength")){var y=Math.round(c/d*C),x=r.data("minDraggerWidth");if(y<=x)r.css({width:x});else if(y>=C-10){var k=C-10;r.css({width:k})}else r.css({width:y})}var T=r.width(),_=(d-c)/(C-T);e.data("scrollAmount",_).mCustomScrollbar("scrolling",n,o,i,r,u,m,l,s);var w=Math.abs(o.position().left);e.mCustomScrollbar("scrollTo",w,{scrollInertia:0,trigger:"internal"})}else n.unbind("mousewheel focusin"),e.data("horizontalScroll")?r.add(o).css("left",0):r.add(o).css("top",0),a.css("display","none"),o.addClass("mCS_no_scrollbar"),e.data({bindEvent_mousewheel:!1,bindEvent_focusin:!1})},scrolling:function(e,o,a,i,r,l,s,c){function d(t,e,n,o){f.data("horizontalScroll")?f.mCustomScrollbar("scrollTo",i.position().left-e+o,{moveDragger:!0,trigger:"internal"}):f.mCustomScrollbar("scrollTo",i.position().top-t+n,{moveDragger:!0,trigger:"internal"})}function u(t){i.data("preventAction")||(i.data("preventAction",!0),f.mCustomScrollbar("scrollTo",t,{trigger:"internal"}))}function m(){var t=f.data("scrollButtons_scrollSpeed");return"auto"===f.data("scrollButtons_scrollSpeed")&&(t=Math.round((f.data("scrollInertia")+100)/40)),t}var f=t(this);if(!f.data("bindEvent_scrollbar_drag")){var h,p;t.support.msPointer?(i.bind("MSPointerDown",function(e){e.preventDefault(),f.data({on_drag:!0}),i.addClass("mCSB_dragger_onDrag");var n=t(this),o=n.offset(),a=e.originalEvent.pageX-o.left,r=e.originalEvent.pageY-o.top;a<n.width()&&a>0&&r<n.height()&&r>0&&(h=r,p=a)}),t(document).bind("MSPointerMove."+f.data("mCustomScrollbarIndex"),function(t){if(t.preventDefault(),f.data("on_drag")){var e=i,n=e.offset(),o=t.originalEvent.pageX-n.left,a=t.originalEvent.pageY-n.top;d(h,p,a,o)}}).bind("MSPointerUp."+f.data("mCustomScrollbarIndex"),function(t){f.data({on_drag:!1}),i.removeClass("mCSB_dragger_onDrag")})):(i.bind("mousedown touchstart",function(e){e.preventDefault(),e.stopImmediatePropagation();var n,o,a=t(this),r=a.offset();if("touchstart"===e.type){var l=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0];n=l.pageX-r.left,o=l.pageY-r.top}else f.data({on_drag:!0}),i.addClass("mCSB_dragger_onDrag"),n=e.pageX-r.left,o=e.pageY-r.top;n<a.width()&&n>0&&o<a.height()&&o>0&&(h=o,p=n)}).bind("touchmove",function(e){e.preventDefault(),e.stopImmediatePropagation();var n=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0],o=t(this),a=o.offset(),i=n.pageX-a.left,r=n.pageY-a.top;d(h,p,r,i)}),t(document).bind("mousemove."+f.data("mCustomScrollbarIndex"),function(t){if(f.data("on_drag")){var e=i,n=e.offset(),o=t.pageX-n.left,a=t.pageY-n.top;d(h,p,a,o)}}).bind("mouseup."+f.data("mCustomScrollbarIndex"),function(t){f.data({on_drag:!1}),i.removeClass("mCSB_dragger_onDrag")})),f.data({bindEvent_scrollbar_drag:!0})}if(t.support.touch&&f.data("contentTouchScroll")&&!f.data("bindEvent_content_touch")){var g,v,b,S,_,w,C;o.bind("touchstart",function(e){e.stopImmediatePropagation(),g=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0],v=t(this),b=v.offset(),_=g.pageX-b.left,S=g.pageY-b.top,w=S,C=_}),o.bind("touchmove",function(e){e.preventDefault(),e.stopImmediatePropagation(),g=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0],v=t(this).parent(),b=v.offset(),_=g.pageX-b.left,S=g.pageY-b.top,f.data("horizontalScroll")?f.mCustomScrollbar("scrollTo",C-_,{trigger:"internal"}):f.mCustomScrollbar("scrollTo",w-S,{trigger:"internal"})})}if(f.data("bindEvent_scrollbar_click")||(a.bind("click",function(e){var n=(e.pageY-a.offset().top)*f.data("scrollAmount"),o=t(e.target);f.data("horizontalScroll")&&(n=(e.pageX-a.offset().left)*f.data("scrollAmount")),(o.hasClass("mCSB_draggerContainer")||o.hasClass("mCSB_draggerRail"))&&f.mCustomScrollbar("scrollTo",n,{trigger:"internal",scrollEasing:"draggerRailEase"})}),f.data({bindEvent_scrollbar_click:!0})),f.data("mouseWheel")&&(f.data("bindEvent_mousewheel")||(e.bind("mousewheel",function(t,e){var n,r=f.data("mouseWheelPixels"),l=Math.abs(o.position().top),s=i.position().top,c=a.height()-i.height();f.data("normalizeMouseWheelDelta")&&(e=e<0?-1:1),"auto"===r&&(r=100+Math.round(f.data("scrollAmount")/2)),f.data("horizontalScroll")&&(s=i.position().left,c=a.width()-i.width(),l=Math.abs(o.position().left)),(e>0&&0!==s||e<0&&s!==c)&&(t.preventDefault(),t.stopImmediatePropagation()),n=l-e*r,f.mCustomScrollbar("scrollTo",n,{trigger:"internal"})}),f.data({bindEvent_mousewheel:!0}))),f.data("scrollButtons_enable"))if("pixels"===f.data("scrollButtons_scrollType"))f.data("horizontalScroll")?(c.add(s).unbind("mousedown touchstart MSPointerDown mouseup MSPointerUp mouseout MSPointerOut touchend",y,x),f.data({bindEvent_buttonsContinuous_x:!1}),f.data("bindEvent_buttonsPixels_x")||(c.bind("click",function(t){t.preventDefault(),u(Math.abs(o.position().left)+f.data("scrollButtons_scrollAmount"))}),s.bind("click",function(t){t.preventDefault(),u(Math.abs(o.position().left)-f.data("scrollButtons_scrollAmount"))}),f.data({bindEvent_buttonsPixels_x:!0}))):(l.add(r).unbind("mousedown touchstart MSPointerDown mouseup MSPointerUp mouseout MSPointerOut touchend",y,x),f.data({bindEvent_buttonsContinuous_y:!1}),f.data("bindEvent_buttonsPixels_y")||(l.bind("click",function(t){t.preventDefault(),u(Math.abs(o.position().top)+f.data("scrollButtons_scrollAmount"))}),r.bind("click",function(t){t.preventDefault(),u(Math.abs(o.position().top)-f.data("scrollButtons_scrollAmount"))}),f.data({bindEvent_buttonsPixels_y:!0})));else if(f.data("horizontalScroll")){if(c.add(s).unbind("click"),f.data({bindEvent_buttonsPixels_x:!1}),!f.data("bindEvent_buttonsContinuous_x")){c.bind("mousedown touchstart MSPointerDown",function(t){t.preventDefault();var e=m();f.data({mCSB_buttonScrollRight:setInterval(function(){f.mCustomScrollbar("scrollTo",Math.abs(o.position().left)+e,{trigger:"internal",scrollEasing:"easeOutCirc"})},17)})});var y=function(t){t.preventDefault(),clearInterval(f.data("mCSB_buttonScrollRight"))};c.bind("mouseup touchend MSPointerUp mouseout MSPointerOut",y),s.bind("mousedown touchstart MSPointerDown",function(t){t.preventDefault();var e=m();f.data({mCSB_buttonScrollLeft:setInterval(function(){f.mCustomScrollbar("scrollTo",Math.abs(o.position().left)-e,{trigger:"internal",scrollEasing:"easeOutCirc"})},17)})});var x=function(t){t.preventDefault(),clearInterval(f.data("mCSB_buttonScrollLeft"))};s.bind("mouseup touchend MSPointerUp mouseout MSPointerOut",x),f.data({bindEvent_buttonsContinuous_x:!0})}}else if(l.add(r).unbind("click"),f.data({bindEvent_buttonsPixels_y:!1}),!f.data("bindEvent_buttonsContinuous_y")){l.bind("mousedown touchstart MSPointerDown",function(t){t.preventDefault();var e=m();f.data({mCSB_buttonScrollDown:setInterval(function(){f.mCustomScrollbar("scrollTo",Math.abs(o.position().top)+e,{trigger:"internal",scrollEasing:"easeOutCirc"})},17)})});var k=function(t){t.preventDefault(),clearInterval(f.data("mCSB_buttonScrollDown"))};l.bind("mouseup touchend MSPointerUp mouseout MSPointerOut",k),r.bind("mousedown touchstart MSPointerDown",function(t){t.preventDefault();var e=m();f.data({mCSB_buttonScrollUp:setInterval(function(){f.mCustomScrollbar("scrollTo",Math.abs(o.position().top)-e,{trigger:"internal",scrollEasing:"easeOutCirc"})},17)})});var T=function(t){t.preventDefault(),clearInterval(f.data("mCSB_buttonScrollUp"))};r.bind("mouseup touchend MSPointerUp mouseout MSPointerOut",T),f.data({bindEvent_buttonsContinuous_y:!0})}f.data("autoScrollOnFocus")&&(f.data("bindEvent_focusin")||(e.bind("focusin",function(){e.scrollTop(0).scrollLeft(0);var n=t(document.activeElement);if(n.is("input,textarea,select,button,a[tabindex],area,object")){var a=o.position().top,i=n.position().top,r=e.height()-n.outerHeight();f.data("horizontalScroll")&&(a=o.position().left,i=n.position().left,r=e.width()-n.outerWidth()),(a+i<0||a+i>r)&&f.mCustomScrollbar("scrollTo",i,{trigger:"internal"})}}),f.data({bindEvent_focusin:!0}))),f.data("autoHideScrollbar")&&(f.data("bindEvent_autoHideScrollbar")||(e.bind("mouseenter",function(t){e.addClass("mCS-mouse-over"),n.showScrollbar.call(e.children(".mCSB_scrollTools"))}).bind("mouseleave touchend",function(t){e.removeClass("mCS-mouse-over"),"mouseleave"===t.type&&n.hideScrollbar.call(e.children(".mCSB_scrollTools"))}),f.data({bindEvent_autoHideScrollbar:!0})))},scrollTo:function(e,o){function a(t){switch(this.mcs={top:f.position().top,left:f.position().left,draggerTop:g.position().top,draggerLeft:g.position().left,topPct:Math.round(100*Math.abs(f.position().top)/Math.abs(f.outerHeight()-m.height())),leftPct:Math.round(100*Math.abs(f.position().left)/Math.abs(f.outerWidth()-m.width()))},t){case"onScrollStart":d.data("mCS_tweenRunning",!0).data("onScrollStart_Callback").call(d,this.mcs);break;case"whileScrolling":d.data("whileScrolling_Callback").call(d,this.mcs);break;case"onScroll":d.data("onScroll_Callback").call(d,this.mcs);break;case"onTotalScrollBack":d.data("onTotalScrollBack_Callback").call(d,this.mcs);break;case"onTotalScroll":d.data("onTotalScroll_Callback").call(d,this.mcs)}}var i,r,l,s,c,d=t(this),u={moveDragger:!1,trigger:"external",callbacks:!0,scrollInertia:d.data("scrollInertia"),scrollEasing:d.data("scrollEasing")},o=t.extend(u,o),m=d.children(".mCustomScrollBox"),f=m.children(".mCSB_container"),h=m.children(".mCSB_scrollTools"),p=h.children(".mCSB_draggerContainer"),g=p.children(".mCSB_dragger"),v=draggerSpeed=o.scrollInertia;if(!f.hasClass("mCS_no_scrollbar")&&(d.data({mCS_trigger:o.trigger}),d.data("mCS_Init")&&(o.callbacks=!1),e||0===e)){if("number"==typeof e)o.moveDragger?(i=e,e=d.data("horizontalScroll")?g.position().left*d.data("scrollAmount"):g.position().top*d.data("scrollAmount"),draggerSpeed=0):i=e/d.data("scrollAmount");else if("string"==typeof e){var b;b="top"===e?0:"bottom"!==e||d.data("horizontalScroll")?"left"===e?0:"right"===e&&d.data("horizontalScroll")?f.outerWidth()-m.width():"first"===e?d.find(".mCSB_container").find(":first"):"last"===e?d.find(".mCSB_container").find(":last"):d.find(e):f.outerHeight()-m.height(),1===b.length?(e=d.data("horizontalScroll")?b.position().left:b.position().top,i=e/d.data("scrollAmount")):i=e=b}if(d.data("horizontalScroll")){d.data("onTotalScrollBack_Offset")&&(l=-d.data("onTotalScrollBack_Offset")),d.data("onTotalScroll_Offset")&&(c=m.width()-f.outerWidth()+d.data("onTotalScroll_Offset")),i<0?(i=e=0,clearInterval(d.data("mCSB_buttonScrollLeft")),l||(r=!0)):i>=p.width()-g.width()?(i=p.width()-g.width(),e=m.width()-f.outerWidth(),clearInterval(d.data("mCSB_buttonScrollRight")),c||(s=!0)):e=-e;var S=d.data("snapAmount");S&&(e=Math.round(e/S)*S-d.data("snapOffset")),n.mTweenAxis.call(this,g[0],"left",Math.round(i),draggerSpeed,o.scrollEasing),n.mTweenAxis.call(this,f[0],"left",Math.round(e),v,o.scrollEasing,{onStart:function(){o.callbacks&&!d.data("mCS_tweenRunning")&&a("onScrollStart"),d.data("autoHideScrollbar")&&n.showScrollbar.call(h)},onUpdate:function(){o.callbacks&&a("whileScrolling")},onComplete:function(){o.callbacks&&(a("onScroll"),(r||l&&f.position().left>=l)&&a("onTotalScrollBack"),(s||c&&f.position().left<=c)&&a("onTotalScroll")),g.data("preventAction",!1),d.data("mCS_tweenRunning",!1),d.data("autoHideScrollbar")&&(m.hasClass("mCS-mouse-over")||n.hideScrollbar.call(h))}})}else{d.data("onTotalScrollBack_Offset")&&(l=-d.data("onTotalScrollBack_Offset")),d.data("onTotalScroll_Offset")&&(c=m.height()-f.outerHeight()+d.data("onTotalScroll_Offset")),i<0?(i=e=0,clearInterval(d.data("mCSB_buttonScrollUp")),l||(r=!0)):i>=p.height()-g.height()?(i=p.height()-g.height(),e=m.height()-f.outerHeight(),clearInterval(d.data("mCSB_buttonScrollDown")),c||(s=!0)):e=-e;var S=d.data("snapAmount");S&&(e=Math.round(e/S)*S-d.data("snapOffset")),n.mTweenAxis.call(this,g[0],"top",Math.round(i),draggerSpeed,o.scrollEasing),n.mTweenAxis.call(this,f[0],"top",Math.round(e),v,o.scrollEasing,{onStart:function(){o.callbacks&&!d.data("mCS_tweenRunning")&&a("onScrollStart"),d.data("autoHideScrollbar")&&n.showScrollbar.call(h)},onUpdate:function(){o.callbacks&&a("whileScrolling")},onComplete:function(){o.callbacks&&(a("onScroll"),(r||l&&f.position().top>=l)&&a("onTotalScrollBack"),(s||c&&f.position().top<=c)&&a("onTotalScroll")),g.data("preventAction",!1),d.data("mCS_tweenRunning",!1),d.data("autoHideScrollbar")&&(m.hasClass("mCS-mouse-over")||n.hideScrollbar.call(h))}})}d.data("mCS_Init")&&d.data({mCS_Init:!1})}},stop:function(){var e=t(this),o=e.children().children(".mCSB_container"),a=e.children().children().children().children(".mCSB_dragger");n.mTweenAxisStop.call(this,o[0]),n.mTweenAxisStop.call(this,a[0])},disable:function(e){var n=t(this),o=n.children(".mCustomScrollBox"),a=o.children(".mCSB_container"),i=o.children(".mCSB_scrollTools"),r=i.children().children(".mCSB_dragger");o.unbind("mousewheel focusin mouseenter mouseleave touchend"),a.unbind("touchstart touchmove"),e&&(n.data("horizontalScroll")?r.add(a).css("left",0):r.add(a).css("top",0)),i.css("display","none"),a.addClass("mCS_no_scrollbar"),n.data({bindEvent_mousewheel:!1,bindEvent_focusin:!1,bindEvent_content_touch:!1,bindEvent_autoHideScrollbar:!1}).addClass("mCS_disabled")},destroy:function(){var e=t(this);e.removeClass("mCustomScrollbar _mCS_"+e.data("mCustomScrollbarIndex")).addClass("mCS_destroyed").children().children(".mCSB_container").unwrap().children().unwrap().siblings(".mCSB_scrollTools").remove(),t(document).unbind("mousemove."+e.data("mCustomScrollbarIndex")+" mouseup."+e.data("mCustomScrollbarIndex")+" MSPointerMove."+e.data("mCustomScrollbarIndex")+" MSPointerUp."+e.data("mCustomScrollbarIndex")),t(window).unbind("resize."+e.data("mCustomScrollbarIndex"))}},n={showScrollbar:function(){this.stop().animate({opacity:1},"fast")},hideScrollbar:function(){this.stop().animate({opacity:0},"fast")},mTweenAxis:function(t,e,n,o,a,i){function r(){return window.performance&&window.performance.now?window.performance.now():window.performance&&window.performance.webkitNow?window.performance.webkitNow():Date.now?Date.now():(new Date).getTime()}function l(){p||u.call(),p=r()-h,s(),p>=t._time&&(t._time=p>t._time?p+d-(p-t._time):p+d-1,t._time<p+1&&(t._time=p+1)),t._time<o?t._id=_request(l):f.call()}function s(){o>0?(t.currVal=c(t._time,g,b,o,a),v[e]=Math.round(t.currVal)+"px"):v[e]=n+"px",m.call()}function c(t,e,n,o,a){switch(a){case"linear":return n*t/o+e;case"easeOutQuad":return t/=o,-n*t*(t-2)+e;case"easeInOutQuad":return(t/=o/2)<1?n/2*t*t+e:(t--,-n/2*(t*(t-2)-1)+e);case"easeOutCubic":return t/=o,t--,n*(t*t*t+1)+e;case"easeOutQuart":return t/=o,t--,-n*(t*t*t*t-1)+e;case"easeOutQuint":return t/=o,t--,n*(t*t*t*t*t+1)+e;case"easeOutCirc":return t/=o,t--,n*Math.sqrt(1-t*t)+e;case"easeOutSine":return n*Math.sin(t/o*(Math.PI/2))+e;case"easeOutExpo":return n*(1-Math.pow(2,-10*t/o))+e;case"mcsEaseOut":var i=(t/=o)*t,r=i*t;return e+n*(.499999999999997*r*i+-2.5*i*i+5.5*r+-6.5*i+4*t);case"draggerRailEase":return(t/=o/2)<1?n/2*t*t*t+e:(t-=2,n/2*(t*t*t+2)+e)}}var d,i=i||{},u=i.onStart||function(){},m=i.onUpdate||function(){},f=i.onComplete||function(){},h=r(),p=0,g=t.offsetTop,v=t.style;"left"===e&&(g=t.offsetLeft);var b=n-g;!function(){null!=t._id&&(window.requestAnimationFrame?window.cancelAnimationFrame(t._id):clearTimeout(t._id),t._id=null)}(),function(){d=1e3/60,t._time=p+d,_request=window.requestAnimationFrame?window.requestAnimationFrame:function(t){return s(),setTimeout(t,.01)},t._id=_request(l)}()},mTweenAxisStop:function(t){null!=t._id&&(window.requestAnimationFrame?window.cancelAnimationFrame(t._id):clearTimeout(t._id),t._id=null)},rafPolyfill:function(){for(var t=["ms","moz","webkit","o"],e=t.length;--e>-1&&!window.requestAnimationFrame;)window.requestAnimationFrame=window[t[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[e]+"CancelAnimationFrame"]||window[t[e]+"CancelRequestAnimationFrame"]}};n.rafPolyfill.call(),t.support.touch=!!("ontouchstart"in window),t.support.msPointer=window.navigator.msPointerEnabled;var o="https:"==document.location.protocol?"https:":"http:";t.event.special.mousewheel||document.write('<script src="'+o+'//cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.0.6/jquery.mousewheel.min.js"><\/script>'),t.fn.mCustomScrollbar=function(n){return e[n]?e[n].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof n&&n?void t.error("Method "+n+" does not exist"):e.init.apply(this,arguments)}}(jQuery)}),define("mouseWheel",function(t,e,n){!function(t){function e(e){var n=e||window.event,o=[].slice.call(arguments,1),a=0,i=0,r=0;return e=t.event.fix(n),e.type="mousewheel",n.wheelDelta&&(a=n.wheelDelta/120),n.detail&&(a=-n.detail/3),r=a,
void 0!==n.axis&&n.axis===n.HORIZONTAL_AXIS&&(r=0,i=-1*a),void 0!==n.wheelDeltaY&&(r=n.wheelDeltaY/120),void 0!==n.wheelDeltaX&&(i=-1*n.wheelDeltaX/120),o.unshift(e,a,i,r),(t.event.dispatch||t.event.handle).apply(this,o)}var n=["DOMMouseScroll","mousewheel"];if(t.event.fixHooks)for(var o=n.length;o;)t.event.fixHooks[n[--o]]=t.event.mouseHooks;t.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var t=n.length;t;)this.addEventListener(n[--t],e,!1);else this.onmousewheel=e},teardown:function(){if(this.removeEventListener)for(var t=n.length;t;)this.removeEventListener(n[--t],e,!1);else this.onmousewheel=null}},t.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})}(jQuery)}),define("widgetMenu",function(t,e,n){"use strict";!function(t){if(!t)return console.warn("widgetMenu needs jQuery");t.fn.widgetMenu=function(e){function n(e){e.preventDefault();var n=t(this).attr("data-entity-id"),o=c?a(e):{};return l.addClass(f).css(o).attr("data-target-id",n),h.addClass(p),!1}function o(t){return t.preventDefault(),l.removeClass(f),h.removeClass(p),!1}function a(e){var n=(u.offset().left,u.offset().top,t(window).height()-e.pageY),o=e.pageX,a=e.pageY;return g>n&&(a-=g),{top:a,left:o}}var i={is_left:!0,trigger:"",tri_par:"",parent:"body",show_class:"",flo_mouse:!1,call:function(){}},r=t.extend(i,e),l=t(this),s=r.is_left?"click":"contextmenu",c=r.flo_mouse,d=r.trigger,u=t(r.trigger),m=t(r.tri_par),f=r.show_class,h=t(".page-mask"),p="menu-show",g=t(this).height(),v=r.call;m.on(s,d,n),l.on("click",o),h.on("click contextmenu",o),v(l)}}(window.jQuery||t("jquery"))}),define("newFolder",function(t,e,n){"use strict";function o(t){var e={is_new:!0,par_folder_level:0,par_folder_id:"root"};$.ajax({url:"/newFolder",type:"POST",dataType:"JSON",data:e,success:function(t){var e="",n="";if(t){e=t.dom_data,n=t.folder_id,d.prepend(e);d.find("div[data-entity-id="+n+"]").find(".rename-cont").renameWidget()}}}),c.mCustomScrollbar("update")}function a(t){var e={is_new:!0},n=$(this).parent(".folder-menu"),o=['<i class="due-if arr-icon">&#xe637;</i>'].join(""),a=['<span class="has-sub-open">','<i class="due-if arr-icon">&#xe636;</i>','<i class="due-if folder-icon">&#xe633;</i>',"</span>"].join(""),i=['<ul class="sub-list">',"</ul>"].join(""),r=n.attr("data-target-id"),l=d.find("div[data-entity-id="+r+"]");if(!l.find(".has-sub .arr-icon")[0]){l.after(i);var s=l.find(".has-sub");s.append(o),s.after(a)}var u=l.next(".sub-list"),m=l.data("level");e.par_folder_level=m,e.par_folder_id=r,$.ajax({url:"/newFolder",type:"POST",dataType:"JSON",data:e,success:function(t){var e="",n="";if(t){e=t.dom_data,n=t.folder_id,u.prepend(e);var o=d.find("div[data-entity-id="+n+"]");l.hasClass("folder-open")||l.find(".has-sub .arr-icon").trigger("click"),o.find(".rename-cont").renameWidget()}}}),c.mCustomScrollbar("update")}t("customScrollBar"),t("renameWidget");var i=$(".bar-top .new-folder"),r=$(".folder-menu"),l=r.eq(0).find(".new-folder"),s=r.eq(1).find(".new-folder"),c=$(".side-bar .folder-item-list"),d=c.find(".mCSB_container");i.on("click",o),l.on("click",a),s.on("click",a)}),define("newNote",function(t,e,n){"use strict";function o(){var t=$(this),e="",n=t.parent(".widget-menu"),o=!!n.hasClass("new-menu"),r=o?"root":n.attr("data-target-id");e=t.hasClass("new-note")?"note":"mk";var l={is_new:!0,type:e,belong_folder_id:r};$.ajax({url:"/newNote",type:"POST",dataType:"JSON",data:l,success:function(t){o?a(t):i(r)}})}function a(t){var e="";t&&(e=t.dom_data,g.prepend(e),h.trigger("click"))}function i(t){f.find("div[data-entity-id="+t+"]").trigger("click")}var r=$(".new-menu .new-note"),l=$(".new-menu .new-mk"),s=$(".folder-menu"),c=s.eq(0).find(".new-note"),d=s.eq(0).find(".new-mk"),u=s.eq(1).find(".new-note"),m=s.eq(1).find(".new-mk"),f=$(".folder-item-list"),h=$(".folder-list-title"),p=$(".view-list"),g=p.find(".mCSB_container");r.on("click",o),l.on("click",o),c.on("click",o),d.on("click",o),u.on("click",o),m.on("click",o)}),define("noteEdit",function(t,e,n){"use strict";function o(t){return t.length>80?t.substring(0,80):t}function a(){var t=$(this),e=t.attr("data-type"),n={};if(t.text("正在保存"),n.note_id=t.attr("data-entity-id"),"note"===e){var a=o(CKEDITOR.instances.editor.document.getBody().getText());n.note_content=CKEDITOR.instances.editor.getData(),n.note_abstract=a}else n.note_content=l.getMarkdown(),n.note_abstract="";$.ajax({url:"/saveNote",type:"POST",dataType:"JSON",data:n,success:function(e){e.is_saved&&(g.hasClass("title-selected")?g.trigger("click"):$(".side-bar-main").find(".selected").trigger("click"),t.text("保存"))}})}function i(){m.trigger("click");var t=$(this),e=t.attr("data-type"),n={};if(t.text("正在生成"),n.belong_note_id=t.attr("data-entity-id"),n.note_type=e,"note"===e){var a=o(CKEDITOR.instances.editor.document.getBody().getText());n.note_content=CKEDITOR.instances.editor.getData(),n.note_abstract=a}else n.note_content=l.getMarkdown(),n.note_abstract="";$.ajax({url:"/verSave",type:"POST",dataType:"JSON",data:n,success:function(e){e.is_saved&&t.text("生成版本")}})}function r(){var t=$(".cke_contents"),e=$(".edit-cont");t.fullHeight({extra:["cke_bottom"]}),e.fullHeight()}var l,s=t("editormd"),c=$(".edit-bar"),d=$(".view-list"),u=c.find(".name-cont"),m=c.find(".save-btn"),f=c.find(".version-btn"),h=c.find(".share-btn"),p=$(".edit-cont"),g=($(".folder-item-list"),$(".folder-list-title")),v={mkEditorInit:function(t){l=s("editor",{width:"100%",height:"100%",path:"/dist/editormd/lib/",codeFold:!0,saveHTMLToTextarea:!0,searchReplace:!0,htmlDecode:"style,script,iframe|on*",emoji:!0,taskList:!0,tocm:!0,tex:!0,flowChart:!0,sequenceDiagram:!0,imageUpload:!0,imageFormats:["jpg","jpeg","gif","png","bmp","webp"],imageUploadURL:"./php/upload.php",readOnly:!1,onload:function(){}})},noteEditorInit:function(){window.CKEDITOR.replace("editor")}};d.on("click",".view-item",function(){var t=$(this),e=t.find(".item-cont"),n=t.find(".btn-text").text(),o=e.attr("data-entity-id"),a=e.attr("data-type"),i=a+"EditorInit";$(this).addClass("selected").siblings(".view-item").removeClass("selected"),u.text(n),m.attr("data-entity-id",o),f.attr("data-entity-id",o),h.attr("data-entity-id",o),m.attr("data-type",a),f.attr("data-type",a),h.attr("data-type",a);var r={note_id:o};$.ajax({url:"/getNote",type:"POST",dataType:"JSON",data:r,success:function(t){var e=t.note_content,n={mk:['<div id="editor"><textarea style="display:none;">'+e+"</textarea></div>"].join(""),note:['<div id="editor">'+e+"</div>"].join("")};p.html("").append(n[a]),(0,v[i])()}})}),m.on("click",a),f.on("click",i),window.CKEDITOR.on("instanceReady",r)}),define("noteShare",function(t,e,n){"use strict";function o(){var t=$(".cke_contents"),e=$(".share-box");t.fullHeight({extra:["cke_bottom"]}),e.fullHeight(),CKEDITOR.instances.editor.setReadOnly(!0)}var a=t("editormd");t("fullPage");var i,r=$("#editor").attr("data-type"),l={mkEditorInit:function(t){i=a("editor",{width:"100%",height:"100%",path:"/dist/editormd/lib/",readOnly:!0,styleActiveLine:!1,lineNumbers:!0})},noteEditorInit:function(){window.CKEDITOR.replace("editor",{toolbarCanCollapse:!1,toolbarStartupExpanded:!1})}};$(".share-box").fullHeight(),window.CKEDITOR.on("instanceReady",o),(0,l[r+"EditorInit"])()}),define("renameWidget",function(t,e,n){"use strict";t("backLayer"),function(t){if(!t)return console.warn("rename needs jQuery");t.fn.renameWidget=function(){function e(t){var e=t.type,o=a.val();if("keydown"===e){13===t.keyCode&&n(o)}else n(o)}function n(e){var n=a.parents(".item-cont"),s=n.children(".btn-text"),c=n.parent().hasClass("folder-item")?"folder":"note";if(""===e)a.val(s.text());else{var d={val:e,entity_id:n.attr("data-entity-id"),entity_type:c};t.ajax({url:"/rename",type:"POST",dataType:"JSON",data:d,success:function(e){if(e.is_tooLong){var i=t(".warn-msg");i.find(".msg-text").text(e.msg),i.backLayer({closeCall:o})}else e&&e.is_affected&&(n.find(".btn-text").eq(0).text(e.new_name),a.val(e.new_name),n.prop("title",e.new_name))}})}a.removeClass(l),i.removeClass(r)}function o(t,e){var n,o=1;n=setInterval(function(){0===--o&&(clearInterval(n),t.hide(),e.remove())},1e3)}var a=t(this),i=t(".page-mask"),r="rename-show",l="ipt-show";return this.each(function(){a.addClass(l).trigger("select"),i.addClass(r),a.one("keydown",e),i.one("click contextmenu",e)})}}(window.jQuery||t("jquery"))}),define("userMsgModify",function(t,e,n){"use strict";function o(){r.backLayer({closeCall:a})}function a(t,e){e.one("click",function(){t.hide(),e.remove()})}t("backLayer");var i=$(".user-control .user-msg-cont"),r=$(".user-msg-modify");i.on("click",o)}),define("verMag",function(t,e,n){"use strict";function o(){var t=$(this),e=t.parent(".widget-menu").attr("data-target-id"),n=v.find("div[data-entity-id="+e+"]").attr("data-type"),o={belong_note_id:e,is_belong_id:!0};$.ajax({url:"/verGet",type:"POST",dataType:"JSON",data:o,success:function(t){t.is_get?(g.html("").append(t.list_dom),f.attr("data-type",n),f.attr("data-target-id",e),p.find(".version-item").eq(0).trigger("click"),f.backLayer({closeCall:s})):($(".warn-msg").find(".msg-text").text("改笔记还未创建任何版本"),$(".warn-msg").backLayer({closeCall:c}))}})}function a(){var t=$(this),e=t.attr("data-entity-id"),n=f.attr("data-type"),o={ver_id:e,is_belong_id:!1};$.ajax({url:"/verGet",type:"POST",dataType:"JSON",data:o,success:function(e){if(e.is_get){t.addClass("item-active").siblings(".version-item").removeClass("item-active");var o=e.note_content,a={mk:['<div id="ver_editor"><textarea style="display:none;">'+o+"</textarea></div>"].join(""),note:['<div id="ver_editor">'+o+"</div>"].join("")};h.html("").append(a[n]);(0,b[n+"EditorInit"])(),"note"===n&&window.CKEDITOR.on("instanceReady",l)}}})}function i(t){t.stopPropagation();var e=$(this).attr("data-back-id"),n={};n.ver_id=e,$.ajax({url:"/verDel",type:"POST",dataType:"JSON",data:n,success:function(t){t.is_del&&(m.trigger("click"),$(".back-layer").trigger("click"))}})}function r(t){t.stopPropagation();var e=f.attr("data-target-id"),n=(f.attr("data-type"),{}),o=$(this).attr("data-back-id"),a={};n.belong_note_id=e,n.ver_id=o,a.ver_id=o,$.ajax({url:"/verBack",type:"POST",dataType:"JSON",data:n,success:function(t){t.is_back&&($(".back-layer").trigger("click"),$(".side-bar-list").find(".selected").trigger("click"),$(".side-bar-list").find(".title-selected").trigger("click"),$.ajax({url:"/verDel",type:"POST",dataType:"JSON",data:a,success:function(t){t.is_del&&console.log("del suc")}}))}})}function l(){CKEDITOR.instances.ver_editor.setReadOnly(!0)}function s(t,e){e.one("click",function(){t.hide(),e.remove()})}function c(t,e){var n,o=1;n=setInterval(function(){0===--o&&(clearInterval(n),t.hide(),e.remove())},1500)}t("customScrollBar"),t("backLayer");var d,u=t("editormd"),m=$(".note-detail-menu .version"),f=$(".version-mag-cont"),h=f.find(".note-cont"),p=f.find(".version-list"),g=p.find(".mCSB_container"),v=$(".view-list"),b={mkEditorInit:function(){d=u("ver_editor",{width:"100%",height:"100%",path:"/dist/editormd/lib/",readOnly:!0,styleActiveLine:!1,lineNumbers:!0})},noteEditorInit:function(){window.CKEDITOR.replace("ver_editor",{toolbarCanCollapse:!1,toolbarStartupExpanded:!1})}};m.on("click",o),p.on("click",".version-item",a),p.on("click",".back-btn",r),p.on("click",".del-btn",i)});