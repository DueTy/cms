define("delFolder",function(t,e,o){"use strict";function n(){var t=$(this).parent(".widget-menu"),e=t.attr("data-target-id"),o=s.find("div[data-entity-id="+e+"]"),n=o.parent().parent().hasClass("sub-list"),a={folder_id:e,folder_level:o.attr("data-level")};$.ajax({url:"/delFolder",type:"POST",dataType:"JSON",data:a,success:function(t){if(t.is_delete_all&&n){if(0===o.parent(".folder-item").siblings().length){var e=o.parent(".folder-item").parent(".sub-list"),a=e.prev(".item-cont");console.log(a),a.removeClass("folder-open"),a.children(".has-sub").find(".arr-icon").remove()}o.remove()}}})}var a=$(".folder-menu"),i=a.eq(0).find(".delete"),l=a.eq(1).find(".delete"),r=$(".side-bar .folder-item-list"),s=r.find(".mCSB_container");i.on("click",n),l.on("click",n)}),define("delNote",function(t,e,o){"use strict";function n(){var t=a.attr("data-target-id"),e=l.find("div[data-entity-id="+t+"]"),o={note_id:t};$.ajax({url:"/delNote",type:"POST",dataType:"JSON",data:o,success:function(t){if(0===e.parent(".view-item").siblings().length){r.html(""),r.append(s);var o=r.find(".empty-msg");o.css("margin-top",l.height()/2-20+"px"),$(window).on("resize",function(){o.css("margin-top",l.height()/2-20+"px")})}e.remove()}})}var a=$(".note-detail-menu"),i=a.find(".delete"),l=$(".view-list"),r=l.find(".mCSB_container");i.on("click",n);var s=['<div class="empty-msg">','<i class="due-if">&#xe8ea;</i><br>',"空文件夹","</div>"].join("")}),define("fullPage",function(t,e,o){"use strict";!function(t){if(!t)return console.warn("fullHeight needs jQuery");t.fn.fullHeight=function(e){function o(){var e=l.offset().top,o=n(r),a=t(window).height();l.css("height",a-e-3-o)}function n(e){var o=0;if(0===e.length)return o;o=10;for(var n=0;n<e.length;n++)o+=t("."+e[n]).height();return o}var a={main:"",extra:[]},i=t.extend(a,e),l=t(this),r=i.extra;o(),t(window).on("resize",o)}}(window.jQuery||t("jquery"))}),define(function(t){function e(){a.toggleClass("page-side-close"),$(window).trigger("resize")}function o(t){t.find(".rename").on("click",function(){var e=t.attr("data-target-id");$("div[data-entity-id="+e+"]").find(".rename-cont").renameWidget()})}function n(){var t={},e=$(this),o=e.attr("data-entity-id");t.belong_folder_id=o,$.ajax({url:"/getNoteList",type:"POST",dataType:"JSON",data:t,success:function(t){var e="";if(t){var o=""===t.list_dom;e=o?m:t.list_dom;var n=s.find(".mCSB_container");if(n.html(""),n.append(e),o){var a=n.find(".empty-msg");a.css("margin-top",s.height()/2-20+"px"),$(window).on("resize",function(){a.css("margin-top",s.height()/2-20+"px")})}if(s.mCustomScrollbar("update"),0!==n.find(".view-item").length)n.find(".view-item").eq(0).trigger("click");else{c.html("").append(h);var a=c.find(".empty-editor");a.css("margin-top",s.height()/2-20+"px"),$(window).on("resize",function(){a.css("margin-top",s.height()/2-20+"px")})}}s.mCustomScrollbar("scrollTo","top")}}),u.removeClass("title-selected"),r.find(".item-cont").removeClass("selected"),!e.hasClass("folder-list-title")?e.addClass("selected"):e.addClass("title-selected")}t("fullPage"),t("mouseWheel"),t("customScrollBar"),t("widgetMenu"),t("renameWidget");var a=$(".main-box"),i=$(".side-close"),l=$(".side-open"),r=$(".folder-item-list"),s=$(".view-list"),c=$(".edit-cont");i.on("click",e),l.on("click",e),c[0]&&(c.fullHeight(),s.fullHeight(),r.fullHeight(),t("noteEdit"));var d={mouseWheelPixels:250,advanced:{autoScrollOnFocus:!1}};s.mCustomScrollbar(d),r.mCustomScrollbar(d),r=$(".folder-item-list"),s=$(".view-list"),t("newNote"),t("newFolder"),t("delFolder"),t("delNote"),$(".new-menu").widgetMenu({tri_par:".side-bar .new-btn",show_class:"blk-show"}),$(".flo-menu").widgetMenu({trigger:".item-cont",show_class:"blk-show",tri_par:".folder-item-list",is_left:!1,flo_mouse:!0,call:o}),$(".down-arr-menu").widgetMenu({trigger:".folder-item .down-arr",tri_par:".folder-item-list",show_class:"blk-show",flo_mouse:!0,call:o}),$(".note-detail-menu").widgetMenu({trigger:".item-cont",show_class:"blk-show",tri_par:".view-list",is_left:!1,flo_mouse:!0,call:o}),r.on("click",".arr-icon",function(){var t=$(this).parents(".item-cont"),e=t.next(".sub-list");t.toggleClass("folder-open"),e.toggleClass("list-open")}),r.on("click",".item-cont",n);var u=$(".side-bar .folder-list-title");u.on("click",n),u.trigger("click"),s.on("click",".item-cont",function(){var t=$(this);t.attr("data-entity-id")});var m=($(".side-bar .new-btn"),$(".side-bar .new-menu"),['<div class="empty-msg">','<i class="due-if">&#xe8ea;</i><br>',"空文件夹","</div>"].join("")),h=['<div class="empty-editor"><i class="due-if">&#xe606;</i></div>'].join("")}),define("backLayer",function(t,e,o){"use strict";!function(t){if(!t)return console.warn("backLayer needs jQuery");t.fn.backLayer=function(e){function o(){var t=Math.max(document.documentElement.scrollWidth,document.documentElement.clientWidth)+"px",e=Math.max(document.documentElement.scrollHeight,document.documentElement.clientHeight)+"px";layer.css({width:t,height:e})}function n(){var e=t(document).scrollTop-c.height()/2+"px",o=t(document).scrollLeft-c.width()/2+"px";c.css({"margin-top":e,"margin-left":o})}var a={closeCall:{},bg_color:"#000"},i=t.extend(a,e),l=!!document.all,r=l&&!window.XMLHttpRequest,s=r?"absolute":"fixed",c=t(this),d=i.bg_color,u=i.closeCall;return this.each(function(){c.css({"z-index":"9999",display:"block",position:s,top:"50%",left:"50%","margin-top":-c.height()/2+"px","margin-left":-c.width()/2+"px"});var e=t("<div></div>");e.css({width:"100%",height:"100%",position:s,top:"0px",left:"0px","background-color":d,"z-index":"9998",opacity:"0.5"}),t("body").append(e),l&&e.css("filter","alpha(opacity=60)"),r&&(o(),n()),t("window").resize(function(){o()}),u(c,e)})}}(window.jQuery||t("jquery"))}),define("customScrollBar",function(t,e,o){!function(t){var e={init:function(e){var o={set_width:!1,set_height:!1,horizontalScroll:!1,scrollInertia:950,mouseWheel:!0,mouseWheelPixels:"auto",autoDraggerLength:!0,autoHideScrollbar:!1,snapAmount:null,snapOffset:0,scrollButtons:{enable:!1,scrollType:"continuous",scrollSpeed:"auto",scrollAmount:40},advanced:{updateOnBrowserResize:!0,updateOnContentResize:!1,autoExpandHorizontalScroll:!1,autoScrollOnFocus:!0,normalizeMouseWheelDelta:!1},contentTouchScroll:!0,callbacks:{onScrollStart:function(){},onScroll:function(){},onTotalScroll:function(){},onTotalScrollBack:function(){},onTotalScrollOffset:0,onTotalScrollBackOffset:0,whileScrolling:function(){}},theme:"light"},e=t.extend(!0,o,e);return this.each(function(){var o=t(this);if(e.set_width&&o.css("width",e.set_width),e.set_height&&o.css("height",e.set_height),t(document).data("mCustomScrollbar-index")){var n=parseInt(t(document).data("mCustomScrollbar-index"));t(document).data("mCustomScrollbar-index",n+1)}else t(document).data("mCustomScrollbar-index","1");o.wrapInner("<div class='mCustomScrollBox mCS-"+e.theme+"' id='mCSB_"+t(document).data("mCustomScrollbar-index")+"' style='position:relative; height:100%; overflow:hidden; max-width:100%;' />").addClass("mCustomScrollbar _mCS_"+t(document).data("mCustomScrollbar-index"));var a=o.children(".mCustomScrollBox");if(e.horizontalScroll){a.addClass("mCSB_horizontal").wrapInner("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />");var i=a.children(".mCSB_h_wrapper");i.wrapInner("<div class='mCSB_container' style='position:absolute; left:0;' />").children(".mCSB_container").css({width:i.children().outerWidth(),position:"relative"}).unwrap()}else a.wrapInner("<div class='mCSB_container' style='position:relative; top:0;' />");var l=a.children(".mCSB_container");t.support.touch&&l.addClass("mCS_touch"),l.after("<div class='mCSB_scrollTools' style='position:absolute;'><div class='mCSB_draggerContainer'><div class='mCSB_dragger' style='position:absolute;' oncontextmenu='return false;'><div class='mCSB_dragger_bar' style='position:relative;'></div></div><div class='mCSB_draggerRail'></div></div></div>");var r=a.children(".mCSB_scrollTools"),s=r.children(".mCSB_draggerContainer"),c=s.children(".mCSB_dragger");if(e.horizontalScroll?c.data("minDraggerWidth",c.width()):c.data("minDraggerHeight",c.height()),e.scrollButtons.enable&&(e.horizontalScroll?r.prepend("<a class='mCSB_buttonLeft' oncontextmenu='return false;'></a>").append("<a class='mCSB_buttonRight' oncontextmenu='return false;'></a>"):r.prepend("<a class='mCSB_buttonUp' oncontextmenu='return false;'></a>").append("<a class='mCSB_buttonDown' oncontextmenu='return false;'></a>")),a.bind("scroll",function(){o.is(".mCS_disabled")||a.scrollTop(0).scrollLeft(0)}),o.data({mCS_Init:!0,mCustomScrollbarIndex:t(document).data("mCustomScrollbar-index"),horizontalScroll:e.horizontalScroll,scrollInertia:e.scrollInertia,scrollEasing:"mcsEaseOut",mouseWheel:e.mouseWheel,mouseWheelPixels:e.mouseWheelPixels,autoDraggerLength:e.autoDraggerLength,autoHideScrollbar:e.autoHideScrollbar,snapAmount:e.snapAmount,snapOffset:e.snapOffset,scrollButtons_enable:e.scrollButtons.enable,scrollButtons_scrollType:e.scrollButtons.scrollType,scrollButtons_scrollSpeed:e.scrollButtons.scrollSpeed,scrollButtons_scrollAmount:e.scrollButtons.scrollAmount,autoExpandHorizontalScroll:e.advanced.autoExpandHorizontalScroll,autoScrollOnFocus:e.advanced.autoScrollOnFocus,normalizeMouseWheelDelta:e.advanced.normalizeMouseWheelDelta,contentTouchScroll:e.contentTouchScroll,onScrollStart_Callback:e.callbacks.onScrollStart,onScroll_Callback:e.callbacks.onScroll,onTotalScroll_Callback:e.callbacks.onTotalScroll,onTotalScrollBack_Callback:e.callbacks.onTotalScrollBack,onTotalScroll_Offset:e.callbacks.onTotalScrollOffset,onTotalScrollBack_Offset:e.callbacks.onTotalScrollBackOffset,whileScrolling_Callback:e.callbacks.whileScrolling,bindEvent_scrollbar_drag:!1,bindEvent_content_touch:!1,bindEvent_scrollbar_click:!1,bindEvent_mousewheel:!1,bindEvent_buttonsContinuous_y:!1,bindEvent_buttonsContinuous_x:!1,bindEvent_buttonsPixels_y:!1,bindEvent_buttonsPixels_x:!1,bindEvent_focusin:!1,bindEvent_autoHideScrollbar:!1,mCSB_buttonScrollRight:!1,mCSB_buttonScrollLeft:!1,mCSB_buttonScrollDown:!1,mCSB_buttonScrollUp:!1}),e.horizontalScroll)"none"!==o.css("max-width")&&(e.advanced.updateOnContentResize||(e.advanced.updateOnContentResize=!0));else if("none"!==o.css("max-height")){var d=!1,u=parseInt(o.css("max-height"));o.css("max-height").indexOf("%")>=0&&(d=u,u=o.parent().height()*d/100),o.css("overflow","hidden"),a.css("max-height",u)}if(o.mCustomScrollbar("update"),e.advanced.updateOnBrowserResize){var m,h=t(window).width(),f=t(window).height();t(window).bind("resize."+o.data("mCustomScrollbarIndex"),function(){m&&clearTimeout(m),m=setTimeout(function(){if(!o.is(".mCS_disabled")&&!o.is(".mCS_destroyed")){var e=t(window).width(),n=t(window).height();h===e&&f===n||("none"!==o.css("max-height")&&d&&a.css("max-height",o.parent().height()*d/100),o.mCustomScrollbar("update"),h=e,f=n)}},150)})}if(e.advanced.updateOnContentResize){if(e.horizontalScroll)var p=l.outerWidth();else var p=l.outerHeight();setInterval(function(){if(e.horizontalScroll){e.advanced.autoExpandHorizontalScroll&&l.css({position:"absolute",width:"auto"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:l.outerWidth(),position:"relative"}).unwrap();var t=l.outerWidth()}else var t=l.outerHeight();t!=p&&(o.mCustomScrollbar("update"),p=t)},300)}})},update:function(){var e=t(this),o=e.children(".mCustomScrollBox"),n=o.children(".mCSB_container");n.removeClass("mCS_no_scrollbar"),e.removeClass("mCS_disabled mCS_destroyed"),o.scrollTop(0).scrollLeft(0);var a=o.children(".mCSB_scrollTools"),i=a.children(".mCSB_draggerContainer"),l=i.children(".mCSB_dragger");if(e.data("horizontalScroll")){var r=a.children(".mCSB_buttonLeft"),s=a.children(".mCSB_buttonRight"),c=o.width();e.data("autoExpandHorizontalScroll")&&n.css({position:"absolute",width:"auto"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:n.outerWidth(),position:"relative"}).unwrap();var d=n.outerWidth()}else var u=a.children(".mCSB_buttonUp"),m=a.children(".mCSB_buttonDown"),h=o.height(),f=n.outerHeight();if(f>h&&!e.data("horizontalScroll")){a.css("display","block");var p=i.height();if(e.data("autoDraggerLength")){var g=Math.round(h/f*p),v=l.data("minDraggerHeight");if(g<=v)l.css({height:v});else if(g>=p-10){var S=p-10;l.css({height:S})}else l.css({height:g});l.children(".mCSB_dragger_bar").css({"line-height":l.height()+"px"})}var b=l.height(),_=(f-h)/(p-b);e.data("scrollAmount",_).mCustomScrollbar("scrolling",o,n,i,l,u,m,r,s);var w=Math.abs(n.position().top);e.mCustomScrollbar("scrollTo",w,{scrollInertia:0,trigger:"internal"})}else if(d>c&&e.data("horizontalScroll")){a.css("display","block");var C=i.width();if(e.data("autoDraggerLength")){var x=Math.round(c/d*C),y=l.data("minDraggerWidth");if(x<=y)l.css({width:y});else if(x>=C-10){var k=C-10;l.css({width:k})}else l.css({width:x})}var B=l.width(),_=(d-c)/(C-B);e.data("scrollAmount",_).mCustomScrollbar("scrolling",o,n,i,l,u,m,r,s);var w=Math.abs(n.position().left);e.mCustomScrollbar("scrollTo",w,{scrollInertia:0,trigger:"internal"})}else o.unbind("mousewheel focusin"),e.data("horizontalScroll")?l.add(n).css("left",0):l.add(n).css("top",0),a.css("display","none"),n.addClass("mCS_no_scrollbar"),e.data({bindEvent_mousewheel:!1,bindEvent_focusin:!1})},scrolling:function(e,n,a,i,l,r,s,c){function d(t,e,o,n){h.data("horizontalScroll")?h.mCustomScrollbar("scrollTo",i.position().left-e+n,{moveDragger:!0,trigger:"internal"}):h.mCustomScrollbar("scrollTo",i.position().top-t+o,{moveDragger:!0,trigger:"internal"})}function u(t){i.data("preventAction")||(i.data("preventAction",!0),h.mCustomScrollbar("scrollTo",t,{trigger:"internal"}))}function m(){var t=h.data("scrollButtons_scrollSpeed");return"auto"===h.data("scrollButtons_scrollSpeed")&&(t=Math.round((h.data("scrollInertia")+100)/40)),t}var h=t(this);if(!h.data("bindEvent_scrollbar_drag")){var f,p;t.support.msPointer?(i.bind("MSPointerDown",function(e){e.preventDefault(),h.data({on_drag:!0}),i.addClass("mCSB_dragger_onDrag");var o=t(this),n=o.offset(),a=e.originalEvent.pageX-n.left,l=e.originalEvent.pageY-n.top;a<o.width()&&a>0&&l<o.height()&&l>0&&(f=l,p=a)}),t(document).bind("MSPointerMove."+h.data("mCustomScrollbarIndex"),function(t){if(t.preventDefault(),h.data("on_drag")){var e=i,o=e.offset(),n=t.originalEvent.pageX-o.left,a=t.originalEvent.pageY-o.top;d(f,p,a,n)}}).bind("MSPointerUp."+h.data("mCustomScrollbarIndex"),function(t){h.data({on_drag:!1}),i.removeClass("mCSB_dragger_onDrag")})):(i.bind("mousedown touchstart",function(e){e.preventDefault(),e.stopImmediatePropagation();var o,n,a=t(this),l=a.offset();if("touchstart"===e.type){var r=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0];o=r.pageX-l.left,n=r.pageY-l.top}else h.data({on_drag:!0}),i.addClass("mCSB_dragger_onDrag"),o=e.pageX-l.left,n=e.pageY-l.top;o<a.width()&&o>0&&n<a.height()&&n>0&&(f=n,p=o)}).bind("touchmove",function(e){e.preventDefault(),e.stopImmediatePropagation();var o=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0],n=t(this),a=n.offset(),i=o.pageX-a.left,l=o.pageY-a.top;d(f,p,l,i)}),t(document).bind("mousemove."+h.data("mCustomScrollbarIndex"),function(t){if(h.data("on_drag")){var e=i,o=e.offset(),n=t.pageX-o.left,a=t.pageY-o.top;d(f,p,a,n)}}).bind("mouseup."+h.data("mCustomScrollbarIndex"),function(t){h.data({on_drag:!1}),i.removeClass("mCSB_dragger_onDrag")})),h.data({bindEvent_scrollbar_drag:!0})}if(t.support.touch&&h.data("contentTouchScroll")&&!h.data("bindEvent_content_touch")){var g,v,S,b,_,w,C;n.bind("touchstart",function(e){e.stopImmediatePropagation(),g=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0],v=t(this),S=v.offset(),_=g.pageX-S.left,b=g.pageY-S.top,w=b,C=_}),n.bind("touchmove",function(e){e.preventDefault(),e.stopImmediatePropagation(),g=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0],v=t(this).parent(),S=v.offset(),_=g.pageX-S.left,b=g.pageY-S.top,h.data("horizontalScroll")?h.mCustomScrollbar("scrollTo",C-_,{trigger:"internal"}):h.mCustomScrollbar("scrollTo",w-b,{trigger:"internal"})})}if(h.data("bindEvent_scrollbar_click")||(a.bind("click",function(e){var o=(e.pageY-a.offset().top)*h.data("scrollAmount"),n=t(e.target);h.data("horizontalScroll")&&(o=(e.pageX-a.offset().left)*h.data("scrollAmount")),(n.hasClass("mCSB_draggerContainer")||n.hasClass("mCSB_draggerRail"))&&h.mCustomScrollbar("scrollTo",o,{trigger:"internal",scrollEasing:"draggerRailEase"})}),h.data({bindEvent_scrollbar_click:!0})),h.data("mouseWheel")&&(h.data("bindEvent_mousewheel")||(e.bind("mousewheel",function(t,e){var o,l=h.data("mouseWheelPixels"),r=Math.abs(n.position().top),s=i.position().top,c=a.height()-i.height();h.data("normalizeMouseWheelDelta")&&(e=e<0?-1:1),"auto"===l&&(l=100+Math.round(h.data("scrollAmount")/2)),h.data("horizontalScroll")&&(s=i.position().left,c=a.width()-i.width(),r=Math.abs(n.position().left)),(e>0&&0!==s||e<0&&s!==c)&&(t.preventDefault(),t.stopImmediatePropagation()),o=r-e*l,h.mCustomScrollbar("scrollTo",o,{trigger:"internal"})}),h.data({bindEvent_mousewheel:!0}))),h.data("scrollButtons_enable"))if("pixels"===h.data("scrollButtons_scrollType"))h.data("horizontalScroll")?(c.add(s).unbind("mousedown touchstart MSPointerDown mouseup MSPointerUp mouseout MSPointerOut touchend",x,y),h.data({bindEvent_buttonsContinuous_x:!1}),h.data("bindEvent_buttonsPixels_x")||(c.bind("click",function(t){t.preventDefault(),u(Math.abs(n.position().left)+h.data("scrollButtons_scrollAmount"))}),s.bind("click",function(t){t.preventDefault(),u(Math.abs(n.position().left)-h.data("scrollButtons_scrollAmount"))}),h.data({bindEvent_buttonsPixels_x:!0}))):(r.add(l).unbind("mousedown touchstart MSPointerDown mouseup MSPointerUp mouseout MSPointerOut touchend",x,y),h.data({bindEvent_buttonsContinuous_y:!1}),h.data("bindEvent_buttonsPixels_y")||(r.bind("click",function(t){t.preventDefault(),u(Math.abs(n.position().top)+h.data("scrollButtons_scrollAmount"))}),l.bind("click",function(t){t.preventDefault(),u(Math.abs(n.position().top)-h.data("scrollButtons_scrollAmount"))}),h.data({bindEvent_buttonsPixels_y:!0})));else if(h.data("horizontalScroll")){if(c.add(s).unbind("click"),h.data({bindEvent_buttonsPixels_x:!1}),!h.data("bindEvent_buttonsContinuous_x")){c.bind("mousedown touchstart MSPointerDown",function(t){t.preventDefault();var e=m();h.data({mCSB_buttonScrollRight:setInterval(function(){h.mCustomScrollbar("scrollTo",Math.abs(n.position().left)+e,{trigger:"internal",scrollEasing:"easeOutCirc"})},17)})});var x=function(t){t.preventDefault(),clearInterval(h.data("mCSB_buttonScrollRight"))};c.bind("mouseup touchend MSPointerUp mouseout MSPointerOut",x),s.bind("mousedown touchstart MSPointerDown",function(t){t.preventDefault();var e=m();h.data({mCSB_buttonScrollLeft:setInterval(function(){h.mCustomScrollbar("scrollTo",Math.abs(n.position().left)-e,{trigger:"internal",scrollEasing:"easeOutCirc"})},17)})});var y=function(t){t.preventDefault(),clearInterval(h.data("mCSB_buttonScrollLeft"))};s.bind("mouseup touchend MSPointerUp mouseout MSPointerOut",y),h.data({bindEvent_buttonsContinuous_x:!0})}}else if(r.add(l).unbind("click"),h.data({bindEvent_buttonsPixels_y:!1}),!h.data("bindEvent_buttonsContinuous_y")){r.bind("mousedown touchstart MSPointerDown",function(t){t.preventDefault();var e=m();h.data({mCSB_buttonScrollDown:setInterval(function(){h.mCustomScrollbar("scrollTo",Math.abs(n.position().top)+e,{trigger:"internal",scrollEasing:"easeOutCirc"})},17)})});var k=function(t){t.preventDefault(),clearInterval(h.data("mCSB_buttonScrollDown"))};r.bind("mouseup touchend MSPointerUp mouseout MSPointerOut",k),l.bind("mousedown touchstart MSPointerDown",function(t){t.preventDefault();var e=m();h.data({mCSB_buttonScrollUp:setInterval(function(){h.mCustomScrollbar("scrollTo",Math.abs(n.position().top)-e,{trigger:"internal",scrollEasing:"easeOutCirc"})},17)})});var B=function(t){t.preventDefault(),clearInterval(h.data("mCSB_buttonScrollUp"))};l.bind("mouseup touchend MSPointerUp mouseout MSPointerOut",B),h.data({bindEvent_buttonsContinuous_y:!0})}h.data("autoScrollOnFocus")&&(h.data("bindEvent_focusin")||(e.bind("focusin",function(){e.scrollTop(0).scrollLeft(0);var o=t(document.activeElement);if(o.is("input,textarea,select,button,a[tabindex],area,object")){var a=n.position().top,i=o.position().top,l=e.height()-o.outerHeight();h.data("horizontalScroll")&&(a=n.position().left,i=o.position().left,l=e.width()-o.outerWidth()),(a+i<0||a+i>l)&&h.mCustomScrollbar("scrollTo",i,{trigger:"internal"})}}),h.data({bindEvent_focusin:!0}))),h.data("autoHideScrollbar")&&(h.data("bindEvent_autoHideScrollbar")||(e.bind("mouseenter",function(t){e.addClass("mCS-mouse-over"),o.showScrollbar.call(e.children(".mCSB_scrollTools"))}).bind("mouseleave touchend",function(t){e.removeClass("mCS-mouse-over"),"mouseleave"===t.type&&o.hideScrollbar.call(e.children(".mCSB_scrollTools"))}),h.data({bindEvent_autoHideScrollbar:!0})))},scrollTo:function(e,n){function a(t){switch(this.mcs={top:h.position().top,left:h.position().left,draggerTop:g.position().top,draggerLeft:g.position().left,topPct:Math.round(100*Math.abs(h.position().top)/Math.abs(h.outerHeight()-m.height())),leftPct:Math.round(100*Math.abs(h.position().left)/Math.abs(h.outerWidth()-m.width()))},t){case"onScrollStart":d.data("mCS_tweenRunning",!0).data("onScrollStart_Callback").call(d,this.mcs);break;case"whileScrolling":d.data("whileScrolling_Callback").call(d,this.mcs);break;case"onScroll":d.data("onScroll_Callback").call(d,this.mcs);break;case"onTotalScrollBack":d.data("onTotalScrollBack_Callback").call(d,this.mcs);break;case"onTotalScroll":d.data("onTotalScroll_Callback").call(d,this.mcs)}}var i,l,r,s,c,d=t(this),u={moveDragger:!1,trigger:"external",callbacks:!0,scrollInertia:d.data("scrollInertia"),scrollEasing:d.data("scrollEasing")},n=t.extend(u,n),m=d.children(".mCustomScrollBox"),h=m.children(".mCSB_container"),f=m.children(".mCSB_scrollTools"),p=f.children(".mCSB_draggerContainer"),g=p.children(".mCSB_dragger"),v=draggerSpeed=n.scrollInertia;if(!h.hasClass("mCS_no_scrollbar")&&(d.data({mCS_trigger:n.trigger}),d.data("mCS_Init")&&(n.callbacks=!1),e||0===e)){if("number"==typeof e)n.moveDragger?(i=e,e=d.data("horizontalScroll")?g.position().left*d.data("scrollAmount"):g.position().top*d.data("scrollAmount"),draggerSpeed=0):i=e/d.data("scrollAmount");else if("string"==typeof e){var S;S="top"===e?0:"bottom"!==e||d.data("horizontalScroll")?"left"===e?0:"right"===e&&d.data("horizontalScroll")?h.outerWidth()-m.width():"first"===e?d.find(".mCSB_container").find(":first"):"last"===e?d.find(".mCSB_container").find(":last"):d.find(e):h.outerHeight()-m.height(),1===S.length?(e=d.data("horizontalScroll")?S.position().left:S.position().top,i=e/d.data("scrollAmount")):i=e=S}if(d.data("horizontalScroll")){d.data("onTotalScrollBack_Offset")&&(r=-d.data("onTotalScrollBack_Offset")),d.data("onTotalScroll_Offset")&&(c=m.width()-h.outerWidth()+d.data("onTotalScroll_Offset")),i<0?(i=e=0,clearInterval(d.data("mCSB_buttonScrollLeft")),r||(l=!0)):i>=p.width()-g.width()?(i=p.width()-g.width(),e=m.width()-h.outerWidth(),clearInterval(d.data("mCSB_buttonScrollRight")),c||(s=!0)):e=-e;var b=d.data("snapAmount");b&&(e=Math.round(e/b)*b-d.data("snapOffset")),o.mTweenAxis.call(this,g[0],"left",Math.round(i),draggerSpeed,n.scrollEasing),o.mTweenAxis.call(this,h[0],"left",Math.round(e),v,n.scrollEasing,{onStart:function(){n.callbacks&&!d.data("mCS_tweenRunning")&&a("onScrollStart"),d.data("autoHideScrollbar")&&o.showScrollbar.call(f)},onUpdate:function(){n.callbacks&&a("whileScrolling")},onComplete:function(){n.callbacks&&(a("onScroll"),(l||r&&h.position().left>=r)&&a("onTotalScrollBack"),(s||c&&h.position().left<=c)&&a("onTotalScroll")),g.data("preventAction",!1),d.data("mCS_tweenRunning",!1),d.data("autoHideScrollbar")&&(m.hasClass("mCS-mouse-over")||o.hideScrollbar.call(f))}})}else{d.data("onTotalScrollBack_Offset")&&(r=-d.data("onTotalScrollBack_Offset")),d.data("onTotalScroll_Offset")&&(c=m.height()-h.outerHeight()+d.data("onTotalScroll_Offset")),i<0?(i=e=0,clearInterval(d.data("mCSB_buttonScrollUp")),r||(l=!0)):i>=p.height()-g.height()?(i=p.height()-g.height(),e=m.height()-h.outerHeight(),clearInterval(d.data("mCSB_buttonScrollDown")),c||(s=!0)):e=-e;var b=d.data("snapAmount");b&&(e=Math.round(e/b)*b-d.data("snapOffset")),o.mTweenAxis.call(this,g[0],"top",Math.round(i),draggerSpeed,n.scrollEasing),o.mTweenAxis.call(this,h[0],"top",Math.round(e),v,n.scrollEasing,{onStart:function(){n.callbacks&&!d.data("mCS_tweenRunning")&&a("onScrollStart"),d.data("autoHideScrollbar")&&o.showScrollbar.call(f)},onUpdate:function(){n.callbacks&&a("whileScrolling")},onComplete:function(){n.callbacks&&(a("onScroll"),(l||r&&h.position().top>=r)&&a("onTotalScrollBack"),(s||c&&h.position().top<=c)&&a("onTotalScroll")),g.data("preventAction",!1),d.data("mCS_tweenRunning",!1),d.data("autoHideScrollbar")&&(m.hasClass("mCS-mouse-over")||o.hideScrollbar.call(f))}})}d.data("mCS_Init")&&d.data({mCS_Init:!1})}},stop:function(){var e=t(this),n=e.children().children(".mCSB_container"),a=e.children().children().children().children(".mCSB_dragger");o.mTweenAxisStop.call(this,n[0]),o.mTweenAxisStop.call(this,a[0])},disable:function(e){var o=t(this),n=o.children(".mCustomScrollBox"),a=n.children(".mCSB_container"),i=n.children(".mCSB_scrollTools"),l=i.children().children(".mCSB_dragger");n.unbind("mousewheel focusin mouseenter mouseleave touchend"),a.unbind("touchstart touchmove"),e&&(o.data("horizontalScroll")?l.add(a).css("left",0):l.add(a).css("top",0)),i.css("display","none"),a.addClass("mCS_no_scrollbar"),o.data({bindEvent_mousewheel:!1,bindEvent_focusin:!1,bindEvent_content_touch:!1,bindEvent_autoHideScrollbar:!1}).addClass("mCS_disabled")},destroy:function(){var e=t(this);e.removeClass("mCustomScrollbar _mCS_"+e.data("mCustomScrollbarIndex")).addClass("mCS_destroyed").children().children(".mCSB_container").unwrap().children().unwrap().siblings(".mCSB_scrollTools").remove(),t(document).unbind("mousemove."+e.data("mCustomScrollbarIndex")+" mouseup."+e.data("mCustomScrollbarIndex")+" MSPointerMove."+e.data("mCustomScrollbarIndex")+" MSPointerUp."+e.data("mCustomScrollbarIndex")),t(window).unbind("resize."+e.data("mCustomScrollbarIndex"))}},o={showScrollbar:function(){this.stop().animate({opacity:1},"fast")},hideScrollbar:function(){this.stop().animate({opacity:0},"fast")},mTweenAxis:function(t,e,o,n,a,i){function l(){return window.performance&&window.performance.now?window.performance.now():window.performance&&window.performance.webkitNow?window.performance.webkitNow():Date.now?Date.now():(new Date).getTime()}function r(){p||u.call(),p=l()-f,s(),p>=t._time&&(t._time=p>t._time?p+d-(p-t._time):p+d-1,t._time<p+1&&(t._time=p+1)),t._time<n?t._id=_request(r):h.call()}function s(){n>0?(t.currVal=c(t._time,g,S,n,a),v[e]=Math.round(t.currVal)+"px"):v[e]=o+"px",m.call()}function c(t,e,o,n,a){switch(a){case"linear":return o*t/n+e;case"easeOutQuad":return t/=n,-o*t*(t-2)+e;case"easeInOutQuad":return(t/=n/2)<1?o/2*t*t+e:(t--,-o/2*(t*(t-2)-1)+e);case"easeOutCubic":return t/=n,t--,o*(t*t*t+1)+e;case"easeOutQuart":return t/=n,t--,-o*(t*t*t*t-1)+e;case"easeOutQuint":return t/=n,t--,o*(t*t*t*t*t+1)+e;case"easeOutCirc":return t/=n,t--,o*Math.sqrt(1-t*t)+e;case"easeOutSine":return o*Math.sin(t/n*(Math.PI/2))+e;case"easeOutExpo":return o*(1-Math.pow(2,-10*t/n))+e;case"mcsEaseOut":var i=(t/=n)*t,l=i*t;return e+o*(.499999999999997*l*i+-2.5*i*i+5.5*l+-6.5*i+4*t);case"draggerRailEase":return(t/=n/2)<1?o/2*t*t*t+e:(t-=2,o/2*(t*t*t+2)+e)}}var d,i=i||{},u=i.onStart||function(){},m=i.onUpdate||function(){},h=i.onComplete||function(){},f=l(),p=0,g=t.offsetTop,v=t.style;"left"===e&&(g=t.offsetLeft);var S=o-g;!function(){null!=t._id&&(window.requestAnimationFrame?window.cancelAnimationFrame(t._id):clearTimeout(t._id),t._id=null)}(),function(){d=1e3/60,t._time=p+d,_request=window.requestAnimationFrame?window.requestAnimationFrame:function(t){return s(),setTimeout(t,.01)},t._id=_request(r)}()},mTweenAxisStop:function(t){null!=t._id&&(window.requestAnimationFrame?window.cancelAnimationFrame(t._id):clearTimeout(t._id),t._id=null)},rafPolyfill:function(){for(var t=["ms","moz","webkit","o"],e=t.length;--e>-1&&!window.requestAnimationFrame;)window.requestAnimationFrame=window[t[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[e]+"CancelAnimationFrame"]||window[t[e]+"CancelRequestAnimationFrame"]}};o.rafPolyfill.call(),t.support.touch=!!("ontouchstart"in window),t.support.msPointer=window.navigator.msPointerEnabled;var n="https:"==document.location.protocol?"https:":"http:";t.event.special.mousewheel||document.write('<script src="'+n+'//cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.0.6/jquery.mousewheel.min.js"><\/script>'),t.fn.mCustomScrollbar=function(o){return e[o]?e[o].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof o&&o?void t.error("Method "+o+" does not exist"):e.init.apply(this,arguments)}}(jQuery)}),define("mouseWheel",function(t,e,o){!function(t){function e(e){var o=e||window.event,n=[].slice.call(arguments,1),a=0,i=0,l=0;return e=t.event.fix(o),e.type="mousewheel",o.wheelDelta&&(a=o.wheelDelta/120),o.detail&&(a=-o.detail/3),l=a,void 0!==o.axis&&o.axis===o.HORIZONTAL_AXIS&&(l=0,i=-1*a),void 0!==o.wheelDeltaY&&(l=o.wheelDeltaY/120),void 0!==o.wheelDeltaX&&(i=-1*o.wheelDeltaX/120),n.unshift(e,a,i,l),(t.event.dispatch||t.event.handle).apply(this,n)}var o=["DOMMouseScroll","mousewheel"];if(t.event.fixHooks)for(var n=o.length;n;)t.event.fixHooks[o[--n]]=t.event.mouseHooks;t.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var t=o.length;t;)this.addEventListener(o[--t],e,!1);else this.onmousewheel=e},teardown:function(){if(this.removeEventListener)for(var t=o.length;t;)this.removeEventListener(o[--t],e,!1);else this.onmousewheel=null}},t.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})}(jQuery)}),define("widgetMenu",function(t,e,o){"use strict";!function(t){if(!t)return console.warn("widgetMenu needs jQuery");t.fn.widgetMenu=function(e){function o(e){e.preventDefault();var o=t(this).attr("data-entity-id"),n=c?a(e):{};return r.addClass(h).css(n).attr("data-target-id",o),f.addClass(p),!1}function n(t){return t.preventDefault(),r.removeClass(h),f.removeClass(p),!1}function a(e){var o=(u.offset().left,u.offset().top,t(window).height()-e.pageY),n=e.pageX,a=e.pageY;return g>o&&(a-=g),{top:a,left:n}}var i={is_left:!0,trigger:"",tri_par:"",parent:"body",show_class:"",flo_mouse:!1,call:function(){}},l=t.extend(i,e),r=t(this),s=l.is_left?"click":"contextmenu",c=l.flo_mouse,d=l.trigger,u=t(l.trigger),m=t(l.tri_par),h=l.show_class,f=t(".page-mask"),p="menu-show",g=t(this).height(),v=l.call;m.on(s,d,o),r.on("click",n),f.on("click contextmenu",n),v(r)}}(window.jQuery||t("jquery"))}),define("newFolder",function(t,e,o){"use strict";function n(t){var e={is_new:!0,par_folder_level:0,par_folder_id:"root"};$.ajax({url:"/newFolder",type:"POST",dataType:"JSON",data:e,success:function(t){var e="",o="";if(t){e=t.dom_data,o=t.folder_id,d.prepend(e);d.find("div[data-entity-id="+o+"]").find(".rename-cont").renameWidget()}}}),c.mCustomScrollbar("update")}function a(t){var e={is_new:!0},o=$(this).parent(".folder-menu"),n=['<i class="due-if arr-icon">&#xe637;</i>'].join(""),a=['<span class="has-sub-open">','<i class="due-if arr-icon">&#xe636;</i>','<i class="due-if folder-icon">&#xe633;</i>',"</span>"].join(""),i=['<ul class="sub-list">',"</ul>"].join(""),l=o.attr("data-target-id"),r=d.find("div[data-entity-id="+l+"]");if(!r.find(".has-sub .arr-icon")[0]){r.after(i);var s=r.find(".has-sub");s.append(n),s.after(a)}var u=r.next(".sub-list"),m=r.data("level");e.par_folder_level=m,e.par_folder_id=l,$.ajax({url:"/newFolder",type:"POST",dataType:"JSON",data:e,success:function(t){var e="",o="";if(t){e=t.dom_data,o=t.folder_id,u.prepend(e)
;var n=d.find("div[data-entity-id="+o+"]");r.hasClass("folder-open")||r.find(".has-sub .arr-icon").trigger("click"),n.find(".rename-cont").renameWidget()}}}),c.mCustomScrollbar("update")}t("customScrollBar"),t("renameWidget");var i=$(".bar-top .new-folder"),l=$(".folder-menu"),r=l.eq(0).find(".new-folder"),s=l.eq(1).find(".new-folder"),c=$(".side-bar .folder-item-list"),d=c.find(".mCSB_container");i.on("click",n),r.on("click",a),s.on("click",a)}),define("newNote",function(t,e,o){"use strict";function n(){var t=$(this),e="",o=t.parent(".widget-menu"),n=!!o.hasClass("new-menu"),l=n?"root":o.attr("data-target-id");e=t.hasClass("new-note")?"note":"mk";var r={is_new:!0,type:e,belong_folder_id:l};$.ajax({url:"/newNote",type:"POST",dataType:"JSON",data:r,success:function(t){n?a(t):i(l)}})}function a(t){var e="";t&&(e=t.dom_data,g.prepend(e),f.trigger("click"))}function i(t){h.find("div[data-entity-id="+t+"]").trigger("click")}var l=$(".new-menu .new-note"),r=$(".new-menu .new-mk"),s=$(".folder-menu"),c=s.eq(0).find(".new-note"),d=s.eq(0).find(".new-mk"),u=s.eq(1).find(".new-note"),m=s.eq(1).find(".new-mk"),h=$(".folder-item-list"),f=$(".folder-list-title"),p=$(".view-list"),g=p.find(".mCSB_container");l.on("click",n),r.on("click",n),c.on("click",n),d.on("click",n),u.on("click",n),m.on("click",n)}),define("noteEdit",function(t,e,o){"use strict";function n(t){return t.length>80?t.substring(0,80):t}function a(){var t=$(this),e=t.attr("data-type"),o={};if(t.text("正在保存"),o.note_id=t.attr("data-entity-id"),"note"===e){var a=n(CKEDITOR.instances.editor.document.getBody().getText());o.note_content=CKEDITOR.instances.editor.getData(),o.note_abstract=a}else o.note_content=l.getMarkdown(),o.note_abstract="";$.ajax({url:"/saveNote",type:"POST",dataType:"JSON",data:o,success:function(e){e.is_saved&&(p.hasClass("title-selected")?p.trigger("click"):f.find(".selected").trigger("click"),t.text("保存"))}})}function i(){var t=$(".cke_contents"),e=$(".edit-cont");t.fullHeight({extra:["cke_bottom"]}),e.fullHeight()}var l,r=t("editormd"),s=$(".edit-bar"),c=$(".view-list"),d=s.find(".name-cont"),u=s.find(".save-btn"),m=s.find(".share-btn"),h=$(".edit-cont"),f=$(".folder-item-list"),p=$(".folder-list-title"),g={mkEditorInit:function(t){l=r("editor",{width:"100%",height:"100%",path:"/dist/editormd/lib/",codeFold:!0,saveHTMLToTextarea:!0,searchReplace:!0,htmlDecode:"style,script,iframe|on*",emoji:!0,taskList:!0,tocm:!0,tex:!0,flowChart:!0,sequenceDiagram:!0,imageUpload:!0,imageFormats:["jpg","jpeg","gif","png","bmp","webp"],imageUploadURL:"./php/upload.php",onload:function(){}})},noteEditorInit:function(){window.CKEDITOR.replace("editor")}};c.on("click",".view-item",function(){var t=$(this),e=t.find(".item-cont"),o=t.find(".btn-text").text(),n=e.attr("data-entity-id"),a=e.attr("data-type"),i=a+"EditorInit";$(this).addClass("selected").siblings(".view-item").removeClass("selected"),d.text(o),u.attr("data-entity-id",n),m.attr("data-entity-id",n),u.attr("data-type",a),m.attr("data-type",a);var l={note_id:n};$.ajax({url:"/getNote",type:"POST",dataType:"JSON",data:l,success:function(t){var e=t.note_content,o={mk:['<div id="editor"><textarea style="display:none;">'+e+"</textarea></div>"].join(""),note:['<div id="editor">'+e+"</div>"].join("")};h.html("").append(o[a]),(0,g[i])()}})}),u.on("click",a),window.CKEDITOR.on("instanceReady",i)}),define("renameWidget",function(t,e,o){"use strict";t("backLayer"),function(t){if(!t)return console.warn("rename needs jQuery");t.fn.renameWidget=function(){function e(t){var e=t.type,n=a.val();if("keydown"===e){13===t.keyCode&&o(n)}else o(n)}function o(e){var o=a.parents(".item-cont"),s=o.children(".btn-text"),c=o.parent().hasClass("folder-item")?"folder":"note";if(""===e)a.val(s.text());else{var d={val:e,entity_id:o.attr("data-entity-id"),entity_type:c};t.ajax({url:"/rename",type:"POST",dataType:"JSON",data:d,success:function(e){if(e.is_tooLong){var i=t(".warn-msg");i.find(".msg-text").text(e.msg),i.backLayer({closeCall:n})}else e&&e.is_affected&&(o.find(".btn-text").eq(0).text(e.new_name),a.val(e.new_name))}})}a.removeClass(r),i.removeClass(l)}function n(t,e){var o,n=1;o=setInterval(function(){0===--n&&(clearInterval(o),t.hide(),e.remove())},1e3)}var a=t(this),i=t(".page-mask"),l="rename-show",r="ipt-show";return this.each(function(){a.addClass(r).trigger("select"),i.addClass(l),a.one("keydown",e),i.one("click contextmenu",e)})}}(window.jQuery||t("jquery"))});